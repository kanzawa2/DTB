#!/usr/sbin/dtrace -q -s
syscall::open:entry
{
  unixtime = walltimestamp / 1000000000;
  self->file = arg0;
}
syscall::open:return
{
  printf("%d|file_open|%d|%s|%s\n", unixtime, pid, execname, copyinstr(self->file));
  self->file = 0;
}