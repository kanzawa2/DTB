#!/usr/sbin/dtrace -q -s
syscall::open:entry
{
  unixtime = walltimestamp / 1000000000;
  self->file = arg0;
}
syscall::open:return
{
  printf("%d|file_open|%d|%s|%s|%d\n", unixtime, pid, execname, copyinstr(self->file), arg1);
  self->file = 0;
}
syscall::close:entry
{
  unixtime = walltimestamp / 1000000000;
  printf("%d|file_close|%d|%s|%d\n", unixtime, pid, execname, arg0);
}
